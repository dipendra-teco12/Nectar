<!-- Small boxes (Stat box) -->
<div class="row">
  <div class="col-lg-3 col-6">
    <!-- small box -->
    <div class="small-box bg-info">
      <div class="inner">
        <h3 id="orderCount">
          <div
            class="spinner-border spinner-border-sm text-white"
            role="status"
          >
            <span class="sr-only">Loading...</span>
          </div>
        </h3>
        <p>New Orders</p>
      </div>
      <div class="icon">
        <i class="ion ion-bag"></i>
      </div>
      <a href="/admin/orders?status=Pending" class="small-box-footer"
        >More info <i class="fas fa-arrow-circle-right"></i
      ></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-6">
    <!-- small box -->
    <div class="small-box bg-success">
      <div class="inner">
        <h3 id="deliveredCount">
          <div
            class="spinner-border spinner-border-sm text-white"
            role="status"
          >
            <span class="sr-only">Loading...</span>
          </div>
        </h3>
        <p>Delivered Orders</p>
      </div>
      <div class="icon">
        <i class="ion ion-stats-bars"></i>
      </div>
      <a href="/admin/orders?status=Delivered" class="small-box-footer"
        >More info <i class="fas fa-arrow-circle-right"></i
      ></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-6">
    <!-- small box -->
    <div class="small-box bg-warning">
      <div class="inner">
        <h3 id="activeUserCount">
          <div
            class="spinner-border spinner-border-sm text-white"
            role="status"
          >
            <span class="sr-only">Loading...</span>
          </div>
        </h3>
        <p>Active Users</p>
      </div>
      <div class="icon">
        <i class="ion ion-person-add"></i>
      </div>
      <a href="/admin/users" class="small-box-footer"
        >More info <i class="fas fa-arrow-circle-right"></i
      ></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-6">
    <!-- small box -->
    <div class="small-box bg-danger">
      <div class="inner">
        <h3 id="totalRevenue">
          <div
            class="spinner-border spinner-border-sm text-white"
            role="status"
          >
            <span class="sr-only">Loading...</span>
          </div>
        </h3>
        <p>Total Revenue</p>
      </div>
      <div class="icon">
        <i class="ion ion-pie-graph"></i>
      </div>
      <a href="/admin/reports/revenue" class="small-box-footer"
        >More info <i class="fas fa-arrow-circle-right"></i
      ></a>
    </div>
  </div>
  <!-- ./col -->
</div>
<!-- /.row -->

<!-- Additional Stats Row -->
<div class="row">
  <div class="col-lg-3 col-6">
    <div class="info-box">
      <span class="info-box-icon bg-info"
        ><i class="fas fa-shopping-cart"></i
      ></span>
      <div class="info-box-content">
        <span class="info-box-text">Products</span>
        <span class="info-box-number" id="productCount">
          <div class="spinner-border spinner-border-sm" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </span>
      </div>
    </div>
  </div>
  <div class="col-lg-3 col-6">
    <div class="info-box">
      <span class="info-box-icon bg-success"><i class="fas fa-tags"></i></span>
      <div class="info-box-content">
        <span class="info-box-text">Categories</span>
        <span class="info-box-number" id="categoryCount">
          <div class="spinner-border spinner-border-sm" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </span>
      </div>
    </div>
  </div>
  <div class="col-lg-3 col-6">
    <div class="info-box">
      <span class="info-box-icon bg-warning"><i class="fas fa-clock"></i></span>
      <div class="info-box-content">
        <span class="info-box-text">Pending Orders</span>
        <span class="info-box-number" id="pendingOrders">
          <div class="spinner-border spinner-border-sm" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </span>
      </div>
    </div>
  </div>
  <div class="col-lg-3 col-6">
    <div class="info-box">
      <span class="info-box-icon bg-danger"
        ><i class="fas fa-exclamation-triangle"></i
      ></span>
      <div class="info-box-content">
        <span class="info-box-text">Low Stock Items</span>
        <span class="info-box-number" id="lowStockCount">
          <div class="spinner-border spinner-border-sm" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </span>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <!-- Left col -->
  <section class="col-lg-7 connectedSortable ui-sortable">
    <!-- Custom tabs (Charts with tabs)-->
    <div class="card">
      <div class="card-header ui-sortable-handle" style="cursor: move">
        <h3 class="card-title">
          <i class="fas fa-chart-pie mr-1"></i>
          Sales Analytics
        </h3>
        <div class="card-tools">
          <ul class="nav nav-pills ml-auto">
            <li class="nav-item">
              <a class="nav-link active" href="#revenue-chart" data-toggle="tab"
                >Revenue</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#sales-chart" data-toggle="tab"
                >Orders</a
              >
            </li>
          </ul>
          <button
            type="button"
            class="btn btn-tool ml-2"
            id="refreshCharts"
            title="Refresh Charts"
          >
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
      </div>
      <!-- /.card-header -->
      <div class="card-body">
        <div class="tab-content p-0">
          <!-- Morris chart - Sales -->
          <div
            class="chart tab-pane active"
            id="revenue-chart"
            style="position: relative; height: 300px"
          >
            <canvas
              id="revenue-chart-canvas"
              height="300"
              style="height: 300px; display: block"
              class="chartjs-render-monitor"
            ></canvas>
          </div>
          <div
            class="chart tab-pane"
            id="sales-chart"
            style="position: relative; height: 300px"
          >
            <canvas
              id="sales-chart-canvas"
              height="300"
              style="height: 300px; display: block"
              class="chartjs-render-monitor"
            ></canvas>
          </div>
        </div>
      </div>
      <!-- /.card-body -->
    </div>
    <!-- /.card -->

    <!-- Recent Orders Card -->
    <!-- <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-shopping-cart mr-1"></i>
          Recent Orders
        </h3>
        <div class="card-tools">
          <button type="button" class="btn btn-tool" id="refreshOrders">
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Amount</th>
                <th>Status</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody id="recentOrdersTable">
              <tr>
                <td colspan="5" class="text-center">
                  <div class="spinner-border" role="status">
                    <span class="sr-only">Loading...</span>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div> -->
  </section>
  <!-- /.Left col -->

  <!-- right col -->
  <section class="col-lg-5 connectedSortable ui-sortable">
    <!-- Quick Actions Card -->
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-bolt mr-1"></i>
          Quick Actions
        </h3>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-6">
            <a href="/admin/products/add" class="btn btn-primary btn-block">
              <i class="fas fa-plus"></i> Add Product
            </a>
          </div>
          <div class="col-6">
            <a href="/admin/orders" class="btn btn-info btn-block">
              <i class="fas fa-list"></i> View Orders
            </a>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-6">
            <a href="/admin/products" class="btn btn-success btn-block">
              <i class="nav-icon fas fa-box"></i> All Products
            </a>
          </div>
          <div class="col-6">
            <a href="/admin/users" class="btn btn-warning btn-block">
              <i class="fas fa-users"></i> Manage Users
            </a>
          </div>
        </div>
      </div>
    </div>
    <!-- Calendar -->
    <div class="card bg-gradient-success">
      <div class="card-header border-0 ui-sortable-handle" style="cursor: move">
        <h3 class="card-title">
          <i class="far fa-calendar-alt"></i>
          Calendar
        </h3>
        <div class="card-tools">
          <button
            type="button"
            class="btn btn-success btn-sm"
            data-card-widget="collapse"
          >
            <i class="fas fa-minus"></i>
          </button>
          <button
            type="button"
            class="btn btn-success btn-sm"
            data-card-widget="remove"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div class="card-body pt-0">
        <!--The calendar -->
        <div id="calendar" style="width: 100%">
          <div class="bootstrap-datetimepicker-widget usetwentyfour">
            <ul class="list-unstyled">
              <li class="show">
                <div class="datepicker">
                  <div class="datepicker-days" style="">
                    <table class="table table-sm">
                      <thead>
                        <tr>
                          <th class="prev" data-action="previous">
                            <span
                              class="fa fa-chevron-left"
                              title="Previous Month"
                            ></span>
                          </th>
                          <th
                            class="picker-switch"
                            data-action="pickerSwitch"
                            colspan="5"
                            title="Select Month"
                          >
                            September 2025
                          </th>
                          <th class="next" data-action="next">
                            <span
                              class="fa fa-chevron-right"
                              title="Next Month"
                            ></span>
                          </th>
                        </tr>
                        <tr>
                          <th class="dow">Su</th>
                          <th class="dow">Mo</th>
                          <th class="dow">Tu</th>
                          <th class="dow">We</th>
                          <th class="dow">Th</th>
                          <th class="dow">Fr</th>
                          <th class="dow">Sa</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td
                            data-action="selectDay"
                            data-day="08/31/2025"
                            class="day old weekend"
                          >
                            31
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/01/2025"
                            class="day"
                          >
                            1
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/02/2025"
                            class="day"
                          >
                            2
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/03/2025"
                            class="day active today"
                          >
                            3
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/04/2025"
                            class="day"
                          >
                            4
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/05/2025"
                            class="day"
                          >
                            5
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/06/2025"
                            class="day weekend"
                          >
                            6
                          </td>
                        </tr>
                        <tr>
                          <td
                            data-action="selectDay"
                            data-day="09/07/2025"
                            class="day weekend"
                          >
                            7
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/08/2025"
                            class="day"
                          >
                            8
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/09/2025"
                            class="day"
                          >
                            9
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/10/2025"
                            class="day"
                          >
                            10
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/11/2025"
                            class="day"
                          >
                            11
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/12/2025"
                            class="day"
                          >
                            12
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/13/2025"
                            class="day weekend"
                          >
                            13
                          </td>
                        </tr>
                        <tr>
                          <td
                            data-action="selectDay"
                            data-day="09/14/2025"
                            class="day weekend"
                          >
                            14
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/15/2025"
                            class="day"
                          >
                            15
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/16/2025"
                            class="day"
                          >
                            16
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/17/2025"
                            class="day"
                          >
                            17
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/18/2025"
                            class="day"
                          >
                            18
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/19/2025"
                            class="day"
                          >
                            19
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/20/2025"
                            class="day weekend"
                          >
                            20
                          </td>
                        </tr>
                        <tr>
                          <td
                            data-action="selectDay"
                            data-day="09/21/2025"
                            class="day weekend"
                          >
                            21
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/22/2025"
                            class="day"
                          >
                            22
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/23/2025"
                            class="day"
                          >
                            23
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/24/2025"
                            class="day"
                          >
                            24
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/25/2025"
                            class="day"
                          >
                            25
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/26/2025"
                            class="day"
                          >
                            26
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/27/2025"
                            class="day weekend"
                          >
                            27
                          </td>
                        </tr>
                        <tr>
                          <td
                            data-action="selectDay"
                            data-day="09/28/2025"
                            class="day weekend"
                          >
                            28
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/29/2025"
                            class="day"
                          >
                            29
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="09/30/2025"
                            class="day"
                          >
                            30
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/01/2025"
                            class="day new"
                          >
                            1
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/02/2025"
                            class="day new"
                          >
                            2
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/03/2025"
                            class="day new"
                          >
                            3
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/04/2025"
                            class="day new weekend"
                          >
                            4
                          </td>
                        </tr>
                        <tr>
                          <td
                            data-action="selectDay"
                            data-day="10/05/2025"
                            class="day new weekend"
                          >
                            5
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/06/2025"
                            class="day new"
                          >
                            6
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/07/2025"
                            class="day new"
                          >
                            7
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/08/2025"
                            class="day new"
                          >
                            8
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/09/2025"
                            class="day new"
                          >
                            9
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/10/2025"
                            class="day new"
                          >
                            10
                          </td>
                          <td
                            data-action="selectDay"
                            data-day="10/11/2025"
                            class="day new weekend"
                          >
                            11
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="datepicker-months" style="display: none">
                    <table class="table-condensed">
                      <thead>
                        <tr>
                          <th class="prev" data-action="previous">
                            <span
                              class="fa fa-chevron-left"
                              title="Previous Year"
                            ></span>
                          </th>
                          <th
                            class="picker-switch"
                            data-action="pickerSwitch"
                            colspan="5"
                            title="Select Year"
                          >
                            2025
                          </th>
                          <th class="next" data-action="next">
                            <span
                              class="fa fa-chevron-right"
                              title="Next Year"
                            ></span>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td colspan="7">
                            <span data-action="selectMonth" class="month"
                              >Jan</span
                            ><span data-action="selectMonth" class="month"
                              >Feb</span
                            ><span data-action="selectMonth" class="month"
                              >Mar</span
                            ><span data-action="selectMonth" class="month"
                              >Apr</span
                            ><span data-action="selectMonth" class="month"
                              >May</span
                            ><span data-action="selectMonth" class="month"
                              >Jun</span
                            ><span data-action="selectMonth" class="month"
                              >Jul</span
                            ><span data-action="selectMonth" class="month"
                              >Aug</span
                            ><span
                              data-action="selectMonth"
                              class="month active"
                              >Sep</span
                            ><span data-action="selectMonth" class="month"
                              >Oct</span
                            ><span data-action="selectMonth" class="month"
                              >Nov</span
                            ><span data-action="selectMonth" class="month"
                              >Dec</span
                            >
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="datepicker-years" style="display: none">
                    <table class="table-condensed">
                      <thead>
                        <tr>
                          <th class="prev" data-action="previous">
                            <span
                              class="fa fa-chevron-left"
                              title="Previous Decade"
                            ></span>
                          </th>
                          <th
                            class="picker-switch"
                            data-action="pickerSwitch"
                            colspan="5"
                            title="Select Decade"
                          >
                            2020-2029
                          </th>
                          <th class="next" data-action="next">
                            <span
                              class="fa fa-chevron-right"
                              title="Next Decade"
                            ></span>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td colspan="7">
                            <span data-action="selectYear" class="year old"
                              >2019</span
                            ><span data-action="selectYear" class="year"
                              >2020</span
                            ><span data-action="selectYear" class="year"
                              >2021</span
                            ><span data-action="selectYear" class="year"
                              >2022</span
                            ><span data-action="selectYear" class="year"
                              >2023</span
                            ><span data-action="selectYear" class="year"
                              >2024</span
                            ><span data-action="selectYear" class="year active"
                              >2025</span
                            ><span data-action="selectYear" class="year"
                              >2026</span
                            ><span data-action="selectYear" class="year"
                              >2027</span
                            ><span data-action="selectYear" class="year"
                              >2028</span
                            ><span data-action="selectYear" class="year"
                              >2029</span
                            ><span data-action="selectYear" class="year old"
                              >2030</span
                            >
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="datepicker-decades" style="display: none">
                    <table class="table-condensed">
                      <thead>
                        <tr>
                          <th class="prev" data-action="previous">
                            <span
                              class="fa fa-chevron-left"
                              title="Previous Century"
                            ></span>
                          </th>
                          <th
                            class="picker-switch"
                            data-action="pickerSwitch"
                            colspan="5"
                          >
                            2000-2090
                          </th>
                          <th class="next" data-action="next">
                            <span
                              class="fa fa-chevron-right"
                              title="Next Century"
                            ></span>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td colspan="7">
                            <span
                              data-action="selectDecade"
                              class="decade old"
                              data-selection="2006"
                              >1990</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2006"
                              >2000</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2016"
                              >2010</span
                            ><span
                              data-action="selectDecade"
                              class="decade active"
                              data-selection="2026"
                              >2020</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2036"
                              >2030</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2046"
                              >2040</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2056"
                              >2050</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2066"
                              >2060</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2076"
                              >2070</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2086"
                              >2080</span
                            ><span
                              data-action="selectDecade"
                              class="decade"
                              data-selection="2096"
                              >2090</span
                            ><span
                              data-action="selectDecade"
                              class="decade old"
                              data-selection="2106"
                              >2100</span
                            >
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </li>
              <li class="picker-switch accordion-toggle"></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- right col -->
</div>

<script>
  $(document).ready(function () {
    // Auto-refresh interval (in milliseconds)
    const REFRESH_INTERVAL = 30000; // 30 seconds

    // Load dashboard data on page load
    loadDashboardData();
    // loadRecentOrders();
    // loadSystemStatus();

    // Set up auto-refresh
    setInterval(function () {
      loadDashboardData();
      // loadRecentOrders();
    }, REFRESH_INTERVAL);

    // Manual refresh buttons
    $("#refreshCharts").on("click", function () {
      loadDashboardData();
      showToast("Charts refreshed", "success");
    });

    $("#refreshOrders").on("click", function () {
      loadRecentOrders();
      showToast("Orders refreshed", "success");
    });

    $("#refreshStatus").on("click", function () {
      loadSystemStatus();
      showToast("Status refreshed", "success");
    });

    // Load main dashboard statistics
    function loadDashboardData() {
      $.ajax({
        url: "/admin/dashboard/stats", // Adjust this URL to match your API endpoint
        type: "GET",
        success: function (response) {
          if (response.data) {
            updateStatBoxes(response.data);
          }
        },
        error: function (xhr, status, error) {
          console.error("Error loading dashboard data:", error);
          showError();
        },
      });
    }

    // Update stat boxes with data
    function updateStatBoxes(data) {
      // Animate numbers
      animateNumber("#orderCount", data.orderCount || 0);
      animateNumber("#deliveredCount", data.deliveredCount || 0);
      animateNumber("#activeUserCount", data.activeUser || 0);
      animateNumber(
        "#totalRevenue",
        "₹" + (data.totalRevenue || 0).toLocaleString()
      );
      animateNumber("#productCount", data.productCount || 0);
      animateNumber("#categoryCount", data.categoryCount || 0);
      animateNumber("#pendingOrders", data.pendingOrders || 0);
      animateNumber("#lowStockCount", data.lowStockCount || 0);
    }

    // Animate number changes
    function animateNumber(selector, endValue) {
      const element = $(selector);
      const isSpinner = element.find(".spinner-border").length > 0;

      if (isSpinner) {
        element.html(endValue);
        element.hide().fadeIn(500);
      } else {
        // Simple animation for number changes
        element.fadeOut(200, function () {
          element.html(endValue).fadeIn(300);
        });
      }
    }

    // Load recent orders
    // function loadRecentOrders() {
    //   $.ajax({
    //     url: "/api/dashboard/recent-orders", // Adjust this URL
    //     type: "GET",
    //     success: function (response) {
    //       updateRecentOrdersTable(response.data || []);
    //     },
    //     error: function (xhr, status, error) {
    //       console.error("Error loading recent orders:", error);
    //       $("#recentOrdersTable").html(
    //         '<tr><td colspan="5" class="text-center text-danger">Error loading orders</td></tr>'
    //       );
    //     },
    //   });
    // }

    // Update recent orders table
    function updateRecentOrdersTable(orders) {
      let html = "";

      if (orders.length === 0) {
        html =
          '<tr><td colspan="5" class="text-center text-muted">No recent orders found</td></tr>';
      } else {
        orders.forEach((order) => {
          const statusClass = getStatusBadgeClass(order.status);
          html += `
                    <tr>
                        <td><small class="text-muted">${order.id.substring(
                          0,
                          8
                        )}...</small></td>
                        <td>${order.customerName}</td>
                        <td>₹${parseFloat(order.amount).toFixed(2)}</td>
                        <td><span class="badge ${statusClass}">${
            order.status
          }</span></td>
                        <td><small>${new Date(
                          order.date
                        ).toLocaleDateString()}</small></td>
                    </tr>
                `;
        });
      }

      $("#recentOrdersTable").html(html);
    }

    // Get status badge class
    function getStatusBadgeClass(status) {
      switch (status.toLowerCase()) {
        case "pending":
          return "badge-warning";
        case "processing":
          return "badge-info";
        case "shipped":
          return "badge-primary";
        case "delivered":
          return "badge-success";
        case "cancelled":
          return "badge-danger";
        default:
          return "badge-secondary";
      }
    }

    // Load system status
    function loadSystemStatus() {
      $.ajax({
        url: "/api/dashboard/system-status",
        type: "GET",
        success: function (response) {
          if (response.data) {
            updateSystemStatus(response.data);
          }
        },
        error: function (xhr, status, error) {
          console.error("Error loading system status:", error);
          // Set default values on error
          updateSystemStatus({
            database: { status: "Unknown", percentage: 0 },
            server: { status: "Unknown", percentage: 0 },
            storage: { status: "Unknown", percentage: 0 },
          });
        },
      });
    }

    // Update system status displays
    function updateSystemStatus(data) {
      // Database status
      $("#dbStatus").text(data.database?.status || "Unknown");
      $("#dbProgressBar").css("width", (data.database?.percentage || 0) + "%");

      // Server status
      $("#serverStatus").text(data.server?.status || "Unknown");
      $("#serverProgressBar").css(
        "width",
        (data.server?.percentage || 0) + "%"
      );

      // Storage status
      $("#storageStatus").text(data.storage?.status || "Unknown");
      $("#storageProgressBar").css(
        "width",
        (data.storage?.percentage || 0) + "%"
      );
    }

    // Show error state
    function showError() {
      $("#orderCount").html(
        '<i class="fas fa-exclamation-triangle text-danger"></i>'
      );
      $("#deliveredCount").html(
        '<i class="fas fa-exclamation-triangle text-danger"></i>'
      );
      $("#activeUserCount").html(
        '<i class="fas fa-exclamation-triangle text-danger"></i>'
      );
      $("#totalRevenue").html(
        '<i class="fas fa-exclamation-triangle text-danger"></i>'
      );
      showToast("Error loading dashboard data", "error");
    }

    // Toast notification function
    function showToast(message, type = "info") {
      if (typeof Swal !== "undefined") {
        const Toast = Swal.mixin({
          toast: true,
          position: "top-end",
          showConfirmButton: false,
          timer: 3000,
          timerProgressBar: true,
        });
        Toast.fire({ icon: type, title: message });
      } else {
        console.log(message);
      }
    }

    // Make showToast globally available
    window.showToast = showToast;
  });
</script>
